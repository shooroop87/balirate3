{% extends "base.html" %}
{% load i18n static %}

{% block title %}{% trans "Cookie-Einstellungen" %} | BlisterPerPost{% endblock %}

{% block content %}
<!-- Page Banner -->
<div class="page-banner-area">
    <div class="container">
        <div class="page-banner-content section-title-animation animation-style2">
            <div class="col-lg-10 col-md-12">
                <div class="page-banner-content">
                    <ul class="meta">
                        <li><a href="{% url 'index' %}">{% trans "Home" %}</a></li>
                        <li>{% trans "Cookie-Einstellungen" %}</li>
                    </ul>
                    <h1>{% trans "Cookie-Einstellungen" %}</h1>
                    <p>{% trans "Hier können Sie Ihre Cookie-Präferenzen verwalten und mehr über die von uns verwendeten Cookies erfahren." %}</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Cookie Settings Content -->
<div class="privacy-policy-area ptb-100">
    <div class="container">
        <div class="privacy-policy-content">

            <blockquote class="blockquote">
                <p>{% trans "Wir verwenden Cookies, um Ihnen die bestmögliche Nutzererfahrung zu bieten. Sie können selbst entscheiden, welche Cookie-Kategorien Sie zulassen möchten." %}</p>
            </blockquote>

            <h3><span>1.</span> {% trans "Was sind Cookies?" %}</h3>
            <p>{% trans "Cookies sind kleine Textdateien, die auf Ihrem Gerät gespeichert werden, wenn Sie unsere Website besuchen. Sie helfen uns, die Website funktionsfähig zu halten, Ihre Präferenzen zu speichern und zu verstehen, wie Sie unsere Website nutzen." %}</p>

            <h3><span>2.</span> {% trans "Ihre Cookie-Einstellungen" %}</h3>
            
            <!-- Cookie Settings Form -->
            <div class="cookie-settings-form bg-light p-4 rounded mb-4">
                <form id="cookieSettingsForm">
                    
                    <!-- Notwendige Cookies -->
                    <div class="cookie-category mb-4 p-3 bg-white rounded">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                                <h4 class="mb-2">
                                    <i class="bi bi-shield-check text-success me-2"></i>
                                    {% trans "Notwendige Cookies" %}
                                </h4>
                                <p class="text-muted mb-0">{% trans "Diese Cookies sind für die Grundfunktionen der Website erforderlich und können nicht deaktiviert werden. Sie werden nur als Reaktion auf von Ihnen durchgeführte Aktionen gesetzt, wie z.B. das Anmelden oder Ausfüllen von Formularen." %}</p>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="necessaryCookies" checked disabled>
                                <label class="form-check-label text-muted" for="necessaryCookies">{% trans "Immer aktiv" %}</label>
                            </div>
                        </div>
                        <div class="mt-3">
                            <small class="text-muted">
                                <strong>{% trans "Verwendete Cookies:" %}</strong> sessionid, csrftoken, django_language, cookie_consent
                            </small>
                        </div>
                    </div>

                    <!-- Funktionale Cookies -->
                    <div class="cookie-category mb-4 p-3 bg-white rounded">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                                <h4 class="mb-2">
                                    <i class="bi bi-gear text-primary me-2"></i>
                                    {% trans "Funktionale Cookies" %}
                                </h4>
                                <p class="text-muted mb-0">{% trans "Diese Cookies ermöglichen erweiterte Funktionen und Personalisierung, wie z.B. das Speichern Ihrer Spracheinstellungen oder das Erinnern an Ihre Anmeldedaten." %}</p>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="functionalCookies">
                                <label class="form-check-label" for="functionalCookies">{% trans "Aktivieren" %}</label>
                            </div>
                        </div>
                        <div class="mt-3">
                            <small class="text-muted">
                                <strong>{% trans "Verwendete Cookies:" %}</strong> remember_me, user_preferences
                            </small>
                        </div>
                    </div>

                    <!-- Analyse Cookies -->
                    <div class="cookie-category mb-4 p-3 bg-white rounded">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                                <h4 class="mb-2">
                                    <i class="bi bi-bar-chart text-info me-2"></i>
                                    {% trans "Analyse-Cookies" %}
                                </h4>
                                <p class="text-muted mb-0">{% trans "Diese Cookies helfen uns zu verstehen, wie Besucher mit unserer Website interagieren. Die Informationen werden anonymisiert gesammelt und helfen uns, unsere Website zu verbessern." %}</p>
                                <p class="text-warning mt-2 mb-0"><small><i class="bi bi-exclamation-triangle me-1"></i>{% trans "Hinweis: Bei Aktivierung können Daten in die USA übertragen werden, wo kein gleichwertiges Datenschutzniveau besteht." %}</small></p>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="analyticsCookies">
                                <label class="form-check-label" for="analyticsCookies">{% trans "Aktivieren" %}</label>
                            </div>
                        </div>
                        <div class="mt-3">
                            <small class="text-muted">
                                <strong>{% trans "Dienste:" %}</strong> Google Analytics (_ga, _gid, _gat)
                            </small>
                        </div>
                    </div>

                    <!-- Marketing Cookies -->
                    <div class="cookie-category mb-4 p-3 bg-white rounded">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="flex-grow-1">
                                <h4 class="mb-2">
                                    <i class="bi bi-megaphone text-danger me-2"></i>
                                    {% trans "Marketing-Cookies" %}
                                </h4>
                                <p class="text-muted mb-0">{% trans "Diese Cookies werden verwendet, um Werbung relevanter für Sie zu gestalten. Sie können auch dazu dienen, die Häufigkeit einer Anzeige zu begrenzen und die Wirksamkeit von Werbekampagnen zu messen." %}</p>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="marketingCookies">
                                <label class="form-check-label" for="marketingCookies">{% trans "Aktivieren" %}</label>
                            </div>
                        </div>
                        <div class="mt-3">
                            <small class="text-muted">
                                <strong>{% trans "Dienste:" %}</strong> {% trans "Derzeit keine Marketing-Cookies im Einsatz" %}
                            </small>
                        </div>
                    </div>

                    <!-- Buttons -->
                    <div class="d-flex flex-wrap gap-2 mt-4">
                        <button type="button" class="btn btn-primary" id="saveSettings">
                            <i class="bi bi-check-lg me-1"></i>{% trans "Auswahl speichern" %}
                        </button>
                        <button type="button" class="btn btn-success" id="acceptAll">
                            <i class="bi bi-check-all me-1"></i>{% trans "Alle akzeptieren" %}
                        </button>
                        <button type="button" class="btn btn-outline-secondary" id="rejectAll">
                            <i class="bi bi-x-lg me-1"></i>{% trans "Nur notwendige" %}
                        </button>
                    </div>
                </form>
            </div>

            <h3><span>3.</span> {% trans "Details zu den Cookie-Kategorien" %}</h3>
            
            <h4>{% trans "Notwendige Cookies" %}</h4>
            <div class="table-responsive mb-4">
                <table class="table table-bordered">
                    <thead class="table-light">
                        <tr>
                            <th>{% trans "Cookie" %}</th>
                            <th>{% trans "Zweck" %}</th>
                            <th>{% trans "Speicherdauer" %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>sessionid</code></td>
                            <td>{% trans "Sitzungsverwaltung für angemeldete Benutzer" %}</td>
                            <td>{% trans "Sitzung" %}</td>
                        </tr>
                        <tr>
                            <td><code>csrftoken</code></td>
                            <td>{% trans "Schutz vor Cross-Site-Request-Forgery-Angriffen" %}</td>
                            <td>{% trans "1 Jahr" %}</td>
                        </tr>
                        <tr>
                            <td><code>django_language</code></td>
                            <td>{% trans "Speichert Ihre bevorzugte Sprache" %}</td>
                            <td>{% trans "1 Jahr" %}</td>
                        </tr>
                        <tr>
                            <td><code>cookie_consent</code></td>
                            <td>{% trans "Speichert Ihre Cookie-Einstellungen" %}</td>
                            <td>{% trans "1 Jahr" %}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h4>{% trans "Analyse-Cookies (Google Analytics)" %}</h4>
            <div class="table-responsive mb-4">
                <table class="table table-bordered">
                    <thead class="table-light">
                        <tr>
                            <th>{% trans "Cookie" %}</th>
                            <th>{% trans "Zweck" %}</th>
                            <th>{% trans "Speicherdauer" %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>_ga</code></td>
                            <td>{% trans "Unterscheidung von Benutzern" %}</td>
                            <td>{% trans "2 Jahre" %}</td>
                        </tr>
                        <tr>
                            <td><code>_gid</code></td>
                            <td>{% trans "Unterscheidung von Benutzern" %}</td>
                            <td>{% trans "24 Stunden" %}</td>
                        </tr>
                        <tr>
                            <td><code>_gat</code></td>
                            <td>{% trans "Begrenzung der Anfragerate" %}</td>
                            <td>{% trans "1 Minute" %}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3><span>4.</span> {% trans "Cookies löschen" %}</h3>
            <p>{% trans "Sie können Cookies jederzeit in Ihren Browsereinstellungen löschen:" %}</p>
            <ul>
                <li><strong>Chrome:</strong> {% trans "Einstellungen → Datenschutz und Sicherheit → Cookies" %}</li>
                <li><strong>Firefox:</strong> {% trans "Einstellungen → Datenschutz & Sicherheit → Cookies" %}</li>
                <li><strong>Safari:</strong> {% trans "Einstellungen → Datenschutz → Websitedaten verwalten" %}</li>
                <li><strong>Edge:</strong> {% trans "Einstellungen → Cookies und Websiteberechtigungen" %}</li>
            </ul>

            <h3><span>5.</span> {% trans "Weitere Informationen" %}</h3>
            <p>{% trans "Weitere Informationen zum Datenschutz finden Sie in unserer" %} <a href="{% url 'privacy' %}">{% trans "Datenschutzerklärung" %}</a>.</p>
            <p>{% trans "Bei Fragen wenden Sie sich an:" %} <a href="mailto:service@balirate.com">service@balirate.com</a></p>

        </div>
    </div>
</div>

{% include "mainpage/overview.html" %}
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Load saved settings
    const consent = JSON.parse(localStorage.getItem('cookie_consent') || '{}');
    
    if (consent.functional) document.getElementById('functionalCookies').checked = true;
    if (consent.analytics) document.getElementById('analyticsCookies').checked = true;
    if (consent.marketing) document.getElementById('marketingCookies').checked = true;
    
    // Save settings
    document.getElementById('saveSettings').addEventListener('click', function() {
        saveConsent({
            necessary: true,
            functional: document.getElementById('functionalCookies').checked,
            analytics: document.getElementById('analyticsCookies').checked,
            marketing: document.getElementById('marketingCookies').checked
        });
    });
    
    // Accept all
    document.getElementById('acceptAll').addEventListener('click', function() {
        document.getElementById('functionalCookies').checked = true;
        document.getElementById('analyticsCookies').checked = true;
        document.getElementById('marketingCookies').checked = true;
        saveConsent({ necessary: true, functional: true, analytics: true, marketing: true });
    });
    
    // Reject all (only necessary)
    document.getElementById('rejectAll').addEventListener('click', function() {
        document.getElementById('functionalCookies').checked = false;
        document.getElementById('analyticsCookies').checked = false;
        document.getElementById('marketingCookies').checked = false;
        saveConsent({ necessary: true, functional: false, analytics: false, marketing: false });
    });
    
    function saveConsent(settings) {
        localStorage.setItem('cookie_consent', JSON.stringify(settings));
        document.cookie = 'cookie_consent=' + JSON.stringify(settings) + ';path=/;max-age=31536000';
        alert('{% trans "Ihre Cookie-Einstellungen wurden gespeichert." %}');
    }
});
</script>
{% endblock %}