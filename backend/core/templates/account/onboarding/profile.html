{% extends "account/onboarding/base_onboarding.html" %}
{% load static i18n %}

{% block title %}{% trans "Profil vervollstÃ¤ndigen" %}{% endblock %}

{% block onboarding_content %}
<div class="onboarding-header">
    <div style="width: 64px; height: 64px; background-color: #f0f4f8; border-radius: 50%; display: inline-block; text-align: center; line-height: 64px; font-size: 32px;">
âœ‰ï¸
</div>
    <h1>{% trans "Willkommen bei BlisterPerPost!" %}</h1>
    <p>{% trans "Bitte vervollstÃ¤ndigen Sie Ihr Profil, damit wir Ihre Medikamente liefern kÃ¶nnen." %}</p>
</div>

<form method="post" class="onboarding-form">
    {% csrf_token %}
    
    <!-- PersÃ¶nliche Daten -->
    <div class="form-section">
        <div class="form-section-title">{% trans "PersÃ¶nliche Daten" %}</div>
        
        <div class="form-row">
            <div class="form-group">
                <label>{% trans "Vorname" %} <span class="required">*</span></label>
                <input type="text" name="first_name" class="form-control" 
                       value="{{ form.first_name.value|default:'' }}" required
                       placeholder="{% trans 'Ihr Vorname' %}">
            </div>
            <div class="form-group">
                <label>{% trans "Nachname" %} <span class="required">*</span></label>
                <input type="text" name="last_name" class="form-control" 
                       value="{{ form.last_name.value|default:'' }}" required
                       placeholder="{% trans 'Ihr Nachname' %}">
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label>{% trans "Telefonnummer" %} <span class="required">*</span></label>
                <input type="tel" name="phone" class="form-control" 
                       value="{{ form.phone.value|default:'' }}" required
                       placeholder="+49 123 456789">
            </div>
            <div class="form-group">
                <label>{% trans "Geburtsdatum" %} <span class="required">*</span></label>
                <input type="date" name="date_of_birth" class="form-control" 
                       value="{{ form.date_of_birth.value|default:'' }}" required>
            </div>
        </div>
    </div>
    
    <!-- Lieferadresse -->
    <div class="form-section">
        <div class="form-section-title">{% trans "Lieferadresse" %}</div>
        
        <div class="form-group">
            <label>{% trans "StraÃŸe und Hausnummer" %} <span class="required">*</span></label>
            <input type="text" name="street" class="form-control" 
                   value="{{ form.street.value|default:'' }}" required
                   placeholder="{% trans 'MusterstraÃŸe 123' %}">
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label>{% trans "Postleitzahl" %} <span class="required">*</span></label>
                <input type="text" name="postal_code" class="form-control" 
                       value="{{ form.postal_code.value|default:'' }}" required
                       placeholder="12345" maxlength="5" pattern="[0-9]{5}">
            </div>
            <div class="form-group">
                <label>{% trans "Stadt" %} <span class="required">*</span></label>
                <input type="text" name="city" class="form-control" 
                       value="{{ form.city.value|default:'' }}" required
                       placeholder="{% trans 'Berlin' %}">
            </div>
        </div>
        
        <div class="form-group">
            <label>{% trans "Land" %}</label>
            <select name="country" class="form-select">
                <option value="DE" {% if form.country.value == 'DE' or not form.country.value %}selected{% endif %}>ğŸ‡©ğŸ‡ª Deutschland</option>
                <option value="AT" {% if form.country.value == 'AT' %}selected{% endif %}>ğŸ‡¦ğŸ‡¹ Ã–sterreich</option>
            </select>
        </div>
    </div>
    
    <!-- Versicherung (optional) -->
    <div class="form-section">
        <div class="form-section-title">{% trans "Krankenversicherung" %} <span style="font-weight:400;color:#64748b">({% trans "optional" %})</span></div>
        
        <div class="form-row">
            <div class="form-group">
                <label>{% trans "Versichertennummer" %}</label>
                <input type="text" name="insurance_number" class="form-control" 
                       value="{{ form.insurance_number.value|default:'' }}"
                       placeholder="{% trans 'Ihre Versichertennummer' %}">
            </div>
            <div class="form-group">
                <label>{% trans "Krankenkasse" %}</label>
                <input type="text" name="insurance_company" class="form-control" 
                       value="{{ form.insurance_company.value|default:'' }}"
                       placeholder="{% trans 'z.B. AOK, TK, Barmer' %}">
            </div>
        </div>
    </div>

    {% if form.errors %}
    <div class="alert alert-danger" style="background:#fef2f2;border:1px solid #fecaca;color:#991b1b;padding:15px;border-radius:12px;margin-bottom:20px;">
        {% for field in form %}
            {% for error in field.errors %}
                <p style="margin:0;">{{ error }}</p>
            {% endfor %}
        {% endfor %}
    </div>
    {% endif %}
    
    <div class="onboarding-actions">
        <button type="submit" class="btn-onboarding primary">
            {% trans "Weiter" %}
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
    </div>
</form>
{% endblock %}
{% block analytics_events %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    if (typeof BPPAnalytics !== 'undefined') {
        BPPAnalytics.trackOnboardingAddress();
    }
    
    var form = document.querySelector('form');
    if (form) {
        form.addEventListener('submit', function() {
            if (typeof BPPAnalytics !== 'undefined') {
                BPPAnalytics.trackOnboardingAddressComplete();
            }
        });
    }
});
</script>
{% endblock %}